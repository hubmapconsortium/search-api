settings:
  index:
    mapping.total_fields.limit: 7500
    query.default_field: 2048

mappings:
  date_detection: False
  dynamic_templates:
    # Removed `copy_to: all_text` 3/8/2024 by Zhou 
    - transposition_kit_number:
        path_match: "*.transposition_kit_number"
        mapping:
          type: text
          fields:
            keyword:
              type: keyword

    # Added 3/8/2024 by Zhou
    # Following expliciitly mapped fields may have values like '17' , '0',  'V11L05-326' , '' , 'Not Applicable'
    # and the default dynamic mapping treats '17' as float but 'Not Applicable' as text, and this causes conflcits
    # Use explicit mapping to normalize the type
    - library_adapter_sequence:
        path_match: "*.library_adapter_sequence"
        mapping:
          type: text
          fields:
            keyword:
              type: keyword

    - umi_offset:
        path_match: "*.umi_offset"
        mapping:
          type: text
          fields:
            keyword:
              type: keyword

    - umi_size:
        path_match: "*.umi_size"
        mapping:
          type: text
          fields:
            keyword:
              type: keyword

    - slide_id:
        path_match: "*.slide_id"
        mapping:
          type: text
          fields:
            keyword:
              type: keyword

    - # Handle all numeric types as float to avoid cast errors
      map_every_numeric:
        match_mapping_type: long
        mapping:
          type: float

    - map_every_string:
        match_mapping_type: string
        mapping:
          copy_to: all_text
          type: text
          fields:
            # This emulates the default ES behavior,
            # giving us a "keyword" subfield,
            # with a "keyword" type.
            keyword:
              type: keyword

